<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMD Glass Editor</title>
    <link rel="stylesheet" href="https://you-app.github.io/MMD-Render-WebGL-Three.js/style.css">
    <script src="https://you-app.github.io/MMD-Render-WebGL-Three.js/lib/jszip/jszip.min.js"></script>
    <script type="importmap">
        {
            "imports": {
                "three": "https://you-app.github.io/MMD-Render-WebGL-Three.js/lib/three/build/r158.js",
                "three/addons/": "https://you-app.github.io/MMD-Render-WebGL-Three.js/lib/three/jsm/"
            }
        }
    </script>
    <style>
        /* Добавляем стили стеклянного морфизма */
        .glass-panel {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            padding: 15px;
            color: white;
        }
        
        .glass-button {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }
        
        .glass-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        .file-plate {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 8px 12px;
            margin: 5px 0;
            cursor: move;
            backdrop-filter: blur(3px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Адаптивная сетка кнопок */
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 10px;
            justify-content: center;
            padding: 10px;
        }
        
        /* Стили для мобильных устройств */
        @media (max-width: 768px) {
            .button-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .content {
                flex-direction: column;
            }
            
            .left-menu, .right-menu {
                width: 100% !important;
                max-width: 100% !important;
            }
        }
    </style>
</head>
<body>
    <div class="main-content">
        <div class="inner">
            <!-- Верхняя панель (упрощенная) -->
            <div class="top-bar glass-panel">
                <div class="top-bar-list">
                    <div class="top-select">MMD Glass Editor</div>
                </div>
            </div>
            
            <div class="content">
                <!-- Левое меню (упрощенное) -->
                <div class="left-menu glass-panel">
                    <div class="lf-container">
                        <div class="top-selection">
                            <div class="option-lf -option-show-">Controls</div>
                        </div>
                        <div class="list-container">
                            <div class="cont-item">
                                <div class="cs-btn" id="load-all">Load All</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Основная область рендеринга -->
                <div class="render">
                    <!-- Контейнер для сцены -->
                    <div class="render-contaner">
                        <div id="scene-container" style="width:100%; height:100%;"></div>
                    </div>
                    
                    <!-- Сетка стеклянных кнопок -->
                    <div class="button-grid">
                        <div class="glass-button" data-panel="model">
                            <span>Model</span>
                        </div>
                        <div class="glass-button" data-panel="camera">
                            <span>Camera</span>
                        </div>
                        <div class="glass-button" data-panel="dance">
                            <span>Dance</span>
                        </div>
                        <div class="glass-button" data-panel="objects">
                            <span>Objects</span>
                        </div>
                        <div class="glass-button" data-panel="audio">
                            <span>Audio</span>
                        </div>
                    </div>
                    
                    <!-- Панели настроек -->
                    <div class="settings-panels">
                        <!-- Панель модели -->
                        <div class="glass-panel model-panel" style="display:none;">
                            <h3>Model Settings</h3>
                            <div class="upper-section">
                                <!-- Сюда будут переноситься выбранные плашки -->
                            </div>
                            <div class="lower-section">
                                <!-- Плашки с названиями файлов -->
                                <div class="file-plate">model1.pmx</div>
                                <div class="file-plate">model2.pmx</div>
                                <div class="file-plate">model3.pmx</div>
                            </div>
                        </div>
                        
                        <!-- Остальные панели (аналогичная структура) -->
                        <div class="glass-panel camera-panel" style="display:none;">
                            <h3>Camera Settings</h3>
                            <div class="upper-section"></div>
                            <div class="lower-section">
                                <div class="file-plate">camera1.vmd</div>
                                <div class="file-plate">camera2.vmd</div>
                            </div>
                        </div>
                        
                        <!-- Аналогичные блоки для dance, objects, audio -->
                    </div>
                </div>
                
                <!-- Правое меню (упрощенное) -->
                <div class="right-menu glass-panel">
                    <div class="rt-container">
                        <div class="top-selection">
                            <div class="option-rt -option-show-">Graphics</div>
                        </div>
                        <div class="list-container">
                            <div class="cont-item">
                                <select class="cs-select-input" id="graph-render-qualiti">
                                    <option value="auto" selected>Auto Quality</option>
                                    <!-- остальные опции -->
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Нижняя панель -->
            <div class="bottom-bar glass-panel">
                <div class="bottom-left">
                    <div class="bottom-item -render-fps">FPS: 60</div>
                </div>
                <div class="bottom-right">
                    <div class="bottom-item -render-size">1920x1080</div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Переносим содержимое render.html в index.html
        
        // Стили сцены
        const sceneStyles = `
            #scene-container {
                position: relative;
                width: 100%;
                height: 100%;
            }
            
            .loadd {
                position: absolute;
                background: rgba(0,0,0,0.7);
                width: 100%;
                height: 100%;
                top: 0;
                left: 0;
                z-index: 9;
            }
            
            canvas {
                display: block;
                width: 100% !important;
                height: 100% !important;
            }
        `;
        
        // Добавляем стили в документ
        const styleSheet = document.createElement("style");
        styleSheet.textContent = sceneStyles;
        document.head.appendChild(styleSheet);
        
        // Создаем контейнер для загрузки
        const sceneContainer = document.getElementById('scene-container');
        const loaderDiv = document.createElement('div');
        loaderDiv.className = 'loadd';
        loaderDiv.innerHTML = `
            <div class="load-cont">
                <div class="load-bar">
                    <div class="bar" style="width:0%"></div>
                </div>
                <div class="load-progr">0%</div>
            </div>
        `;
        sceneContainer.appendChild(loaderDiv);
        
        // Создаем canvas для рендеринга
        const canvas = document.createElement('canvas');
        sceneContainer.appendChild(canvas);
        
        // Инициализация Three.js сцены
        import * as THREE from 'three';
        import { MMDLoader } from 'three/addons/loaders/MMDLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        
        // Ваш код инициализации сцены из render.js
        // (здесь должен быть код инициализации Three.js сцены)
        // Для примера - базовая сцена:
        
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        renderer.setSize(sceneContainer.clientWidth, sceneContainer.clientHeight);
        
        // Освещение
        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(0, 1, 1);
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x404040));
        
        // Контролы
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        
        // Загрузка модели
        const loader = new MMDLoader();
        loader.load(
            'https://you-app.github.io/MMD-Render-WebGL-Three.js/models/chiori/chiori.pmx',
            (object) => {
                scene.add(object);
                loaderDiv.style.display = 'none';
            },
            (progress) => {
                const percent = Math.round(progress.loaded / progress.total * 100);
                loaderDiv.querySelector('.bar').style.width = `${percent}%`;
                loaderDiv.querySelector('.load-progr').textContent = `${percent}%`;
            },
            (error) => {
                console.error('Error loading model:', error);
            }
        );
        
        camera.position.z = 10;
        
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();
        
        // Адаптивность
        window.addEventListener('resize', () => {
            camera.aspect = sceneContainer.clientWidth / sceneContainer.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(sceneContainer.clientWidth, sceneContainer.clientHeight);
        });
        
        // Логика стеклянных кнопок
        const buttons = document.querySelectorAll('.glass-button');
        const panels = document.querySelectorAll('.settings-panels > div');
        
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                const panelId = button.dataset.panel;
                
                // Скрыть все панели
                panels.forEach(panel => {
                    panel.style.display = 'none';
                });
                
                // Показать соответствующую панель
                const targetPanel = document.querySelector(`.${panelId}-panel`);
                if (targetPanel) {
                    targetPanel.style.display = 'block';
                }
            });
        });
        
        // Drag-and-drop для плашек
        const filePlates = document.querySelectorAll('.file-plate');
        const upperSections = document.querySelectorAll('.upper-section');
        
        filePlates.forEach(plate => {
            plate.setAttribute('draggable', 'true');
            
            plate.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', plate.textContent);
            });
        });
        
        upperSections.forEach(section => {
            section.addEventListener('dragover', (e) => {
                e.preventDefault();
                section.style.backgroundColor = 'rgba(255,255,255,0.2)';
            });
            
            section.addEventListener('dragleave', () => {
                section.style.backgroundColor = '';
            });
            
            section.addEventListener('drop', (e) => {
                e.preventDefault();
                const fileName = e.dataTransfer.getData('text/plain');
                
                // Создаем новую плашку в верхней секции
                const newPlate = document.createElement('div');
                newPlate.className = 'file-plate';
                newPlate.textContent = fileName;
                section.appendChild(newPlate);
                
                section.style.backgroundColor = '';
            });
        });
        
        // Кнопка Load All
        document.getElementById('load-all').addEventListener('click', () => {
            alert('Loading selected content...');
            // Здесь будет логика загрузки выбранного контента
        });
    </script>
</body>
</html>
